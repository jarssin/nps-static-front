<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>NPS</title>
    <!-- <base href="/"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="stylesheet" href="src/css/styles.css"> 
    <script src="src/js/scripts.js"></script>
  </head>
<body>
  <form autocomplete="off">
    <h2>Como você avalia nossos serviços?</h2>
    <div class="rating-container">
      <label>
        <input type="radio" name="score" value="1">
        <div class="rating-box" id="super-unsatisfied">
          <span>1</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="2">
        <div class="rating-box" id="super-unsatisfied">
          <span>2</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="3">
        <div class="rating-box" id="super-unsatisfied">
          <span>3</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="4">
        <div class="rating-box" id="super-unsatisfied">
          <span>4</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="5">
        <div class="rating-box" id="super-unsatisfied">
          <span>5</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="6">
        <div class="rating-box" id="super-unsatisfied">
          <span>6</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="7">
        <div class="rating-box" id="neutral">
          <span>7</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="8">
        <div class="rating-box" id="neutral">
          <span>8</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="9">
        <div class="rating-box" id="satisfied">
          <span>9</span>
        </div>
      </label>
      <label>
        <input type="radio" name="score" value="10">
        <div class="rating-box" id="satisfied">
          <span>10</span>
        </div>
      </label>
    </div>
    <h2>Queremos entender melhor a sua experiência</h2>
    <input id="comment-input" type="text" name="comment" placeholder="Deixe seu comentário (opcional)">
    
    <button type="submit" id="submit-btn">
      <span class="btn-text">Enviar</span>
      <span class="spinner hidden"></span>
    </button>
  </form>

<script>
  const form = document.querySelector("form");
  const radios = document.querySelectorAll('input[name="score"]');
  const commentField = document.getElementById("comment-input");

  let typingTimeout = null;
  let submitTimeout = null;

  function startAutoSubmitCountdown() {
    submitTimeout = setTimeout(() => {
      form.submit();
    }, 5000); // Envia após 5 segundos de inatividade
  }

  function resetTypingTimer() {
    if (submitTimeout) clearTimeout(submitTimeout);
    if (typingTimeout) clearTimeout(typingTimeout);

    typingTimeout = setTimeout(() => {
      startAutoSubmitCountdown();
    }, 2000); // Considera que parou de digitar após 2 segundos
  }

  commentField.addEventListener("input", () => {
    resetTypingTimer();
  });

  radios.forEach(radio => {
    radio.addEventListener("change", () => {
      commentField.focus();

      if (submitTimeout) clearTimeout(submitTimeout);
      submitTimeout = setTimeout(() => {
        form.submit();
      }, 10000); // Envia após 10 segundos se não digitar nada
    });
  });
</script>

</body>
</html>
